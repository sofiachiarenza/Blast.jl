<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · Blast.jl</title><meta name="title" content="API · Blast.jl"/><meta property="og:title" content="API · Blast.jl"/><meta property="twitter:title" content="API · Blast.jl"/><meta name="description" content="Documentation for Blast.jl."/><meta property="og:description" content="Documentation for Blast.jl."/><meta property="twitter:description" content="Documentation for Blast.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Blast.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Blast.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../alg/">The algorithm</a></li><li class="is-active"><a class="tocitem" href>API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/sofiachiarenza/Blast.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/sofiachiarenza/Blast.jl/blob/main/docs/src/api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API-reference"><a class="docs-heading-anchor" href="#API-reference">API reference</a><a id="API-reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-reference" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.FlatΛCDM" href="#Blast.FlatΛCDM"><code>Blast.FlatΛCDM</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FlatΛCDM{T}(; w0 = -1.0, wa = 0.0, H0 = 67.27, Ωm = 0.3156, Ωb = 0.0492, 
    Ωde = 0.6844, As = 2.12107e-9, σ8 = 0.816, Ωk = 0.0, Ωr = 0.0, ns = 0.9645
)</code></pre><p><strong>Parameters:</strong></p><ul><li><code>w0</code>: Dark energy equation of state parameter at present time (default: -1).</li><li><code>wa</code>: Time evolution of the dark energy equation of state (default: 0).</li><li><code>H0</code>: Hubble constant in km/s/Mpc (default: 67.27).</li><li><code>Ωm</code>: Matter density parameter (default: 0.3156).</li><li><code>Ωb</code>: Baryon density parameter (default: 0.0492).</li><li><code>Ωde</code>: Dark energy density parameter (default: 0.6844).</li><li><code>As</code>: Scalar amplitude of the primordial power spectrum (default: 2.12107e-9).</li><li><code>σ8</code>: Root-mean-square density fluctuation in spheres of radius 8 Mpc (default: 0.816).</li><li><code>Ωk</code>: Curvature density parameter (default: 0, for flat universe).</li><li><code>Ωr</code>: Radiation density parameter (default: 0, since radiation is negligible at low redshift).</li><li><code>ns</code>: Scalar spectral index (default: 0.9645).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/cosmo.jl#L29-L46">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.BackgroundQuantities" href="#Blast.BackgroundQuantities"><code>Blast.BackgroundQuantities</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">BackgroundQuantities{T}(; Hz_array, χz_array)</code></pre><p><strong>Parameters:</strong></p><ul><li><code>Hz_array</code>: Array of Hubble parameter values, evaluated on a grid of redshift values (default: zeros(500)).</li><li><code>χz_array</code>: Array of comoving distance values, evaluated on a grid of redshift values (default: zeros(500)).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/cosmo.jl#L74-L80">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.AbstractCosmology" href="#Blast.AbstractCosmology"><code>Blast.AbstractCosmology</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractCosmology{T}</code></pre><p>An abstract type representing a general cosmological model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/cosmo.jl#L1-L4">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.AbstractBackgroundQuantities" href="#Blast.AbstractBackgroundQuantities"><code>Blast.AbstractBackgroundQuantities</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractBackgroundQuantities{T}</code></pre><p>An abstract type for background quantities in cosmology, such as the Hubble parameter (<code>H</code>), comoving distance (<code>χ</code>),  and the growth factor (<code>D</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/cosmo.jl#L13-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.AbstractCosmologicalGrid" href="#Blast.AbstractCosmologicalGrid"><code>Blast.AbstractCosmologicalGrid</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractCosmologicalGrid{T}</code></pre><p>An abstract type representing a grid on which cosmological quantities are evaluated.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/cosmo.jl#L7-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.AbstractCosmologicalProbes" href="#Blast.AbstractCosmologicalProbes"><code>Blast.AbstractCosmologicalProbes</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractCosmologicalProbes{T}</code></pre><p>An abstract type for the shear, clustering and CMB lensing kernels.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/cosmo.jl#L20-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.CosmologicalGrid" href="#Blast.CosmologicalGrid"><code>Blast.CosmologicalGrid</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CosmologicalGrid{T}(; z_range, k_range)</code></pre><p><strong>Parameters:</strong></p><ul><li><code>z_range</code>: Array of redshift values where quantities like the Hubble parameter are evaluated (default: LinRange(0.001, 2.5, 300)).</li><li><code>k_range</code>: Array of wavenumbers for evaluating power spectra or other k-dependent quantities (default: LogSpaced(1e-5, 50, 1000)).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/cosmo.jl#L62-L67">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.GalaxyKernel" href="#Blast.GalaxyKernel"><code>Blast.GalaxyKernel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GalaxyKernel{T} &lt;: AbstractCosmologicalProbes{T}</code></pre><p>Represents a galaxy kernel in cosmological calculations, where kernel values are provided for multiple tomographic bins.</p><p><strong>Parameters</strong></p><ul><li><code>Kernel::AbstractArray{T, 2}</code>: A 2D array of type <code>T</code>, with dimensions <code>(n_bins, nχ)</code>. This stores kernel values for each tomographic bin and a grid of χ values.</li></ul><p><strong>Constructors</strong></p><ul><li><code>GalaxyKernel{T}(n_bins::Int, nχ::Int)</code>: Creates a <code>GalaxyKernel</code> with the specified <code>n_bins</code> and <code>nχ</code> values, initializing the kernel values to zeros of type <code>T</code>.</li><li><code>GalaxyKernel(n_bins::Int, nχ::Int)</code>: Creates a <code>GalaxyKernel</code> with the specified <code>n_bins</code> and <code>nχ</code> values, initializing the kernel values to zeros of type <code>Float64</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/cosmo.jl#L87-L98">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.ShearKernel" href="#Blast.ShearKernel"><code>Blast.ShearKernel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ShearKernel{T} &lt;: AbstractCosmologicalProbes{T}</code></pre><p>Represents a shear kernel used in cosmological lensing calculations. The kernel is defined over multiple tomographic bins.</p><p><strong>Parameters</strong></p><ul><li><code>Kernel::AbstractArray{T, 2}</code>: A 2D array of type <code>T</code>, with dimensions <code>(n_bins, nχ)</code>. Stores the kernel values for each tomographic bin and a grid of χ values.</li></ul><p><strong>Constructors</strong></p><ul><li><code>ShearKernel{T}(n_bins::Int, nχ::Int)</code>: Creates a <code>ShearKernel</code> with the specified <code>n_bins</code> and <code>nχ</code> values, initializing the kernel values to zeros of type <code>T</code>.</li><li><code>ShearKernel(n_bins::Int, nχ::Int)</code>: Creates a <code>ShearKernel</code> with the specified <code>n_bins</code> and <code>nχ</code> values, initializing the kernel values to zeros of type <code>Float64</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/cosmo.jl#L108-L119">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.CMBLensingKernel" href="#Blast.CMBLensingKernel"><code>Blast.CMBLensingKernel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CMBLensingKernel{T} &lt;: AbstractCosmologicalProbes{T}</code></pre><p>Represents a CMB lensing kernel.</p><p><strong>Parameters</strong></p><ul><li><code>Kernel::AbstractArray{T, 2}</code>: A 2D array of type <code>T</code>, with dimensions <code>(n_bins, nχ)</code>. Note that CMB Lensing by definition only has a single tomographic bin.</li></ul><p><strong>Constructors</strong></p><ul><li><code>CMBLensingKernel{T}(n_bins::Int, nχ::Int)</code>: Creates a <code>CMBLensingKernel</code> with the specified <code>n_bins</code> and <code>nχ</code> values, initializing the kernel values to zeros of type <code>T</code>.</li><li><code>CMBLensingKernel(n_bins::Int, nχ::Int)</code>: Creates a <code>CMBLensingKernel</code> with the specified <code>n_bins</code> and <code>nχ</code> values, initializing the kernel values to zeros of type <code>Float64</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/cosmo.jl#L129-L140">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.compute_T̃" href="#Blast.compute_T̃"><code>Blast.compute_T̃</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_T̃(ℓ::Number, χ::AbstractArray, R::AbstractArray, kmin::Number, kmax::Number, β::Number; n_cheb::Int = 119, N::Int = 2^(15)+1)</code></pre><p>Compute integrals of the Bessels function and the Chebyshev polynomials. This is the precomputation part of the code.</p><p><strong>Arguments</strong></p><ul><li><p><code>ℓ::Number</code>: Multipole order</p></li><li><p><code>χ::AbstractArray</code>: Array containing values of the comoving distance. </p></li><li><p><code>R::AbstractArray</code>: Array containing values for the R=χ₁/χ₂ variable.</p></li><li><p><code>kmin::Number</code> and <code>kmax::Number</code>: Integration range in k.</p></li><li><p><code>β::Number</code>: Exponent of the k dependence of the integral. This parameter depends on the combination of tracers: β=2,-2,0 for clustering, cosmic shear and the cross-correlation respectively.</p></li><li><p><code>n_cheb::Int</code>: Number of chebyshev polynomials used in the approximation of the power spectra.</p></li><li><p><code>N::Int</code>: Number of integration points in k.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/projected_matter.jl#L67-L85">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.bessel_cheb_eval" href="#Blast.bessel_cheb_eval"><code>Blast.bessel_cheb_eval</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bessel_cheb_eval(ℓ::Number, kmin::Number, kmax::Number, χ::AbstractArray, n_cheb::Int, N::Number)</code></pre><p>Return the Chebyshev polynomials up to order &#39;n_cheb+1&#39; and the Bessel function of order &#39;ℓ&#39; evaluated on the grid of &#39;N&#39; Chebyshev points in the interval [&#39;kmin&#39;, &#39;kmax&#39;] and on the specified &#39;χ&#39; points. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/projected_matter.jl#L38-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.get_clencurt_weights" href="#Blast.get_clencurt_weights"><code>Blast.get_clencurt_weights</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_clencurt_weights(kmin::Number, kmax::Number, N::Number)</code></pre><p>Return the set of &#39;N&#39; weights needed to perform the integration with the Clenshaw-Curtis quadrature rule. The weights are rescaled between &#39;kmin&#39; and &#39;kmax&#39;.  </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/projected_matter.jl#L25-L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.get_clencurt_grid" href="#Blast.get_clencurt_grid"><code>Blast.get_clencurt_grid</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_clencurt_grid(kmin::Number, kmax::Number, N::Number)</code></pre><p>Return the integration points in k. They are a set of &#39;N&#39; Chebyshev points rescaled between &#39;kmin&#39; and &#39;kmax&#39;.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/projected_matter.jl#L10-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.w_ell_tullio" href="#Blast.w_ell_tullio"><code>Blast.w_ell_tullio</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">w_ell_tullio(c::AbstractArray,T::AbstractArray)</code></pre><p>Compute the tensor contraction of the chebyshev coefficients of the power spectrum &#39;c&#39; and the precomputed integrals &#39;T&#39; to obtain the projected matter densities.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/projected_matter.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.plan_fft" href="#Blast.plan_fft"><code>Blast.plan_fft</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plan_fft(vals::AbstractArray{&lt;:Number,N})</code></pre><p>Create an FFTW real-to-real (R2R) transformation plan for the first axis of a given multidimensional array <code>vals</code>.  In practise, the <code>vals</code> array is the power spectrum P(k,χ). The first axis should then contains the wavenumbers <code>k</code>, while the second axis contains the <code>χ</code> information.</p><p><strong>Arguments</strong></p><ul><li><code>vals::AbstractArray{&lt;:Number, N}</code>: The input array of any numerical type with <code>N</code> dimensions.</li></ul><p><strong>Returns</strong></p><ul><li><code>p::FFTW.rFFTWPlan</code>: A FFTW plan object for transforming <code>vals</code> with the appropriate real to real transformations. This plan can be applied using the <code>*</code> operator (e.g., <code>transformed_vals = p * vals</code>).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/chebcoefs.jl#L1-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.fast_chebcoefs" href="#Blast.fast_chebcoefs"><code>Blast.fast_chebcoefs</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fast_chebcoefs(vals::AbstractArray{&lt;:Number,N}, plan::FFTW.r2rFFTWPlan)</code></pre><p>Efficiently compute the Chebyshev coefficients of a multidimensional array <code>vals</code> using an O(n log n) method. This method leverages FFT-based type-I Discrete Cosine Transform (DCT-I).</p><p>Arguments:</p><ul><li><p><code>vals::AbstractArray{&lt;:Number,N}</code>: A multidimensional array of values for which to compute the Chebyshev coefficients.</p></li><li><p><code>plan::FFTW.r2rFFTWPlan</code>: A FFTW plan object for transforming <code>vals</code> with the appropriate real to real transformations. This plan is applied using the <code>*</code> operator (e.g., <code>transformed_vals = p * vals</code>) and performs the DCT of the <code>vals</code> array along the first axis.</p></li></ul><p>Returns:</p><ul><li><code>coefs</code>: An array of the same size as <code>vals</code>, containing the computed Chebyshev coefficients.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/chebcoefs.jl#L22-L34">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.make_grid" href="#Blast.make_grid"><code>Blast.make_grid</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">make_grid(BackgroundQuantities::BackgroundQuantities, R::Vector{T}) where T</code></pre><p>Constructs a grid by multiplying the <code>χz_array</code> from <code>BackgroundQuantities</code> with the vector <code>R</code>.</p><p><strong>Arguments</strong></p><ul><li><code>BackgroundQuantities::BackgroundQuantities</code>: An instance of the <code>BackgroundQuantities</code> type that contains the <code>χz_array</code>.</li><li><code>R::Vector{T}</code>: A vector of values to be used in the grid construction, where <code>T</code> can be any type.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/integrals.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.grid_interpolator-Union{Tuple{T}, Tuple{Union{Blast.GalaxyKernel, Blast.ShearKernel}, Blast.BackgroundQuantities, Vector{T}}} where T" href="#Blast.grid_interpolator-Union{Tuple{T}, Tuple{Union{Blast.GalaxyKernel, Blast.ShearKernel}, Blast.BackgroundQuantities, Vector{T}}} where T"><code>Blast.grid_interpolator</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">grid_interpolator(Probe::Union{GalaxyKernel, ShearKernel}, 
    BackgroundQuantities::BackgroundQuantities, grid::Vector{T}) where T</code></pre><p>Interpolates the kernel values for a given grid based on the specified cosmological probes.  Returns a 2D array of interpolated kernel values, where rows correspond to the number of bins and columns correspond to the grid points.</p><p><strong>Arguments</strong></p><ul><li><code>Probe::Union{GalaxyKernel, ShearKernel}</code>: The kernel data to be interpolated.</li><li><code>BackgroundQuantities::BackgroundQuantities</code>: An instance of the <code>BackgroundQuantities</code> type that contains the <code>χz_array</code>.</li><li><code>grid::Vector{T}</code>: A vector of values where the interpolated kernel values will be evaluated.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/integrals.jl#L14-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.grid_interpolator-Union{Tuple{T}, Tuple{Blast.CMBLensingKernel, Blast.BackgroundQuantities, Vector{T}}} where T" href="#Blast.grid_interpolator-Union{Tuple{T}, Tuple{Blast.CMBLensingKernel, Blast.BackgroundQuantities, Vector{T}}} where T"><code>Blast.grid_interpolator</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">grid_interpolator(Probe::CMBLensingKernel, 
    bg::BackgroundQuantities, grid::Vector{T}) where T</code></pre><p>Interpolates the kernel values for a given grid based on the specified cosmological probes.  Returns a 2D array of interpolated kernel values, where rows correspond to the number of bins and columns correspond to the grid points.</p><p><strong>Arguments</strong></p><ul><li><code>Probe::CMBLensingKernel</code>: The kernel data to be interpolated.</li><li><code>bg::BackgroundQuantities</code>: An instance of the <code>BackgroundQuantities</code> type that contains the <code>χz_array</code>.</li><li><code>grid::Vector{T}</code>: A vector of values where the interpolated kernel values will be evaluated.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/integrals.jl#L40-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.get_kernel_array-Union{Tuple{T}, Tuple{Blast.GalaxyKernel, Blast.BackgroundQuantities, Vector{T}}} where T" href="#Blast.get_kernel_array-Union{Tuple{T}, Tuple{Blast.GalaxyKernel, Blast.BackgroundQuantities, Vector{T}}} where T"><code>Blast.get_kernel_array</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_kernel_array(AbstractCosmologicalProbes::GalaxyKernel, 
    BackgroundQuantities::BackgroundQuantities, R::Vector{T}) where T</code></pre><p>Obtains the kernel array for the <code>GalaxyKernel</code> probe, with dimensions (bins, nχ, nR). </p><p><strong>Arguments</strong></p><ul><li><code>AbstractCosmologicalProbes::GalaxyKernel</code>: An instance of the <code>GalaxyKernel</code> type.</li><li><code>BackgroundQuantities::BackgroundQuantities</code>: An instance of the <code>BackgroundQuantities</code> type.</li><li><code>R::Vector{T}</code>: A vector of values for which the kernel array is to be computed.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/integrals.jl#L63-L74">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.get_kernel_array-Union{Tuple{T}, Tuple{Blast.ShearKernel, Blast.BackgroundQuantities, Vector{T}}} where T" href="#Blast.get_kernel_array-Union{Tuple{T}, Tuple{Blast.ShearKernel, Blast.BackgroundQuantities, Vector{T}}} where T"><code>Blast.get_kernel_array</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_kernel_array(Probe::ShearKernel, 
    bg::BackgroundQuantities, R::Vector{T}) where T</code></pre><p>Obtains the kernel array for the weak lensing probe, with dimensions (bins, nχ, nR) The difference with respect to the galaxy case is that these kernels are divided by <span>$\chi^2$</span>.</p><p><strong>Arguments</strong></p><ul><li><code>Probe::ShearKernel</code>: An instance of <code>ShearKernel</code>.</li><li><code>bg::BackgroundQuantities</code>: An instance of the <code>BackgroundQuantities</code> type.</li><li><code>R::Vector{T}</code>: A vector of values for which the kernel array is to be computed.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/integrals.jl#L87-L98">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.get_kernel_array-Union{Tuple{T}, Tuple{Blast.CMBLensingKernel, Blast.BackgroundQuantities, Vector{T}}} where T" href="#Blast.get_kernel_array-Union{Tuple{T}, Tuple{Blast.CMBLensingKernel, Blast.BackgroundQuantities, Vector{T}}} where T"><code>Blast.get_kernel_array</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_kernel_array(Probe::CMBLensingKernel, 
    bg::BackgroundQuantities, R::Vector{T}) where T</code></pre><p>Obtains the kernel array for the CMB lensing probe, with dimensions (1, nχ, nR) Similarly to the weak lensing case, the kernel is divided by <span>$\chi^2$</span>.</p><p><strong>Arguments</strong></p><ul><li><code>Probe::CMBLensingKernel</code>: An instance of <code>CMBLensingKernel</code>.</li><li><code>bg::BackgroundQuantities</code>: An instance of the <code>BackgroundQuantities</code> type.</li><li><code>R::Vector{T}</code>: A vector of values for which the kernel array is to be computed.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/integrals.jl#L118-L129">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.combine_kernels" href="#Blast.combine_kernels"><code>Blast.combine_kernels</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">combine_kernels(ProbeA::Union{GalaxyKernel, ShearKernel, CMBLensingKernel}, 
    ProbeB::Union{GalaxyKernel, ShearKernel, CMBLensingKernel}, 
    BackgroundQuantities::BackgroundQuantities, R::Vector{T}) where T</code></pre><p>Combines the kernels from two different cosmological probes into a single array.  This is needed to perform the integration in the χ-R coordinates.</p><p><strong>Arguments</strong></p><ul><li><code>ProbeA::Union{GalaxyKernel, ShearKernel, CMBLensingKernel}</code>: The first cosmological probe to combine.</li><li><code>ProbeB::Union{GalaxyKernel, ShearKernel, CMBLensingKernel}</code>: The second cosmological probe to combine.</li><li><code>BackgroundQuantities::BackgroundQuantities</code>: An instance of the <code>BackgroundQuantities</code> type.</li><li><code>R::Vector{T}</code>: A vector of values used in the combination.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/integrals.jl#L145-L158">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.factorial_frac" href="#Blast.factorial_frac"><code>Blast.factorial_frac</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">factorial_frac(ℓ::Union{Number,Vector{T}}}) where T</code></pre><p>Computes the ratio (ℓ+2)!/(ℓ-2)!, needed in the pre-factors of the the angular power spectra.</p><p><strong>Arguments</strong></p><ul><li><code>ℓ::Vector{T}</code>: vectors of ℓ values.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/integrals.jl#L174-L181">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.get_ell_prefactor-Tuple{Blast.GalaxyKernel, Blast.GalaxyKernel, Vector}" href="#Blast.get_ell_prefactor-Tuple{Blast.GalaxyKernel, Blast.GalaxyKernel, Vector}"><code>Blast.get_ell_prefactor</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_ell_prefactor(ProbeA::GalaxyKernel, ProbeB::GalaxyKernel, ℓ_list::Vector)</code></pre><p>Calculates the prefactor for the angular power spectrum when both probes are <code>GalaxyKernel</code>.</p><p><strong>Arguments</strong></p><ul><li><code>ℓ_list::Vector</code>: A vector of angular multipole values.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/integrals.jl#L186-L193">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.get_ell_prefactor-Tuple{Blast.GalaxyKernel, Blast.ShearKernel, Vector}" href="#Blast.get_ell_prefactor-Tuple{Blast.GalaxyKernel, Blast.ShearKernel, Vector}"><code>Blast.get_ell_prefactor</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_ell_prefactor(ProbeA::GalaxyKernel, ProbeB::ShearKernel, ℓ_list::Vector)</code></pre><p>Calculates the prefactor for the angular power spectrum when probes are <code>GalaxyKernel</code> and <code>ShearKernel</code>.</p><p><strong>Arguments</strong></p><ul><li><code>ℓ_list::Vector</code>: A vector of angular multipole values.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/integrals.jl#L198-L205">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.get_ell_prefactor-Tuple{Blast.ShearKernel, Blast.ShearKernel, Vector}" href="#Blast.get_ell_prefactor-Tuple{Blast.ShearKernel, Blast.ShearKernel, Vector}"><code>Blast.get_ell_prefactor</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_ell_prefactor(ProbeA::ShearKernel, ProbeB::ShearKernel, ℓ_list::Vector)</code></pre><p>Calculates the prefactor for the angular power spectrum when both probes are <code>ShearKernel</code>.</p><p><strong>Arguments</strong></p><ul><li><code>ℓ_list::Vector</code>: A vector of angular multipole values.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/integrals.jl#L214-L221">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.get_ell_prefactor-Tuple{Blast.CMBLensingKernel, Blast.ShearKernel, Vector}" href="#Blast.get_ell_prefactor-Tuple{Blast.CMBLensingKernel, Blast.ShearKernel, Vector}"><code>Blast.get_ell_prefactor</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_ell_prefactor(ProbeA::CMBLensingKernel, ProbeB::ShearKernel, ℓ_list::Vector)</code></pre><p>Calculates the prefactor for the angular power spectrum when probes are <code>CMBLensingKernel</code> and <code>ShearKernel</code>.</p><p><strong>Arguments</strong></p><ul><li><code>ℓ_list::Vector</code>: A vector of angular multipole values.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/integrals.jl#L226-L233">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.get_ell_prefactor-Tuple{Blast.CMBLensingKernel, Blast.CMBLensingKernel, Vector}" href="#Blast.get_ell_prefactor-Tuple{Blast.CMBLensingKernel, Blast.CMBLensingKernel, Vector}"><code>Blast.get_ell_prefactor</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_ell_prefactor(ProbeA::CMBLensingKernel, ProbeB::CMBLensingKernel, ℓ_list::Vector)</code></pre><p>Calculates the prefactor for the angular power spectrum when both probes are <code>CMBLensingKernel</code>.</p><p><strong>Arguments</strong></p><ul><li><code>ℓ_list::Vector</code>: A vector of angular multipole values.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/integrals.jl#L242-L249">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.get_ell_prefactor-Tuple{Blast.CMBLensingKernel, Blast.GalaxyKernel, Vector}" href="#Blast.get_ell_prefactor-Tuple{Blast.CMBLensingKernel, Blast.GalaxyKernel, Vector}"><code>Blast.get_ell_prefactor</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_ell_prefactor(ProbeA::CMBLensingKernel, ProbeB::GalaxyKernel, ℓ_list::Vector)</code></pre><p>Calculates the prefactor for the angular power spectrum when probes are <code>CMBLensingKernel</code> and <code>GalaxyKernel</code>.</p><p><strong>Arguments</strong></p><ul><li><code>ℓ_list::Vector</code>: A vector of angular multipole values.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/integrals.jl#L254-L261">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.simpson_weight_array" href="#Blast.simpson_weight_array"><code>Blast.simpson_weight_array</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simpson_weight_array(n::Int; T=Float64)</code></pre><p>Computes the weights for the Simpson quadrature rule for numerical integration based on the input number of points <code>n</code>.</p><p><strong>Arguments</strong></p><ul><li><code>n::Int</code>: The number of points (must be at least 2).</li><li><code>T</code>: (optional) The type of the output array. Defaults to <code>Float64</code>.</li></ul><p><strong>Returns</strong></p><ul><li>An array of length <code>n</code> with the weights of type <code>T</code> for the Simpson quadrature rule.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/integrals.jl#L270-L281">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.get_clencurt_weights_R_integration" href="#Blast.get_clencurt_weights_R_integration"><code>Blast.get_clencurt_weights_R_integration</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_clencurt_weights_R_integration(N::Int)</code></pre><p>Calculate Clenshaw-Curtis quadrature weights for numerical integration over a given interval. The weights are computed for the second half of the Chebyshev points, omitting the zero element.  The first weight is halved, although this is an approximation and may benefit from further optimization.</p><p><strong>Arguments</strong></p><ul><li><code>N::Int</code>: The number of quadrature points.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/integrals.jl#L312-L321">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.compute_Cℓ-Union{Tuple{T}, Tuple{AbstractArray{T, 3}, Union{Blast.CMBLensingKernel, Blast.GalaxyKernel, Blast.ShearKernel}, Union{Blast.CMBLensingKernel, Blast.GalaxyKernel, Blast.ShearKernel}, Blast.BackgroundQuantities, AbstractVector}, Tuple{AbstractArray{T, 3}, Union{Blast.CMBLensingKernel, Blast.GalaxyKernel, Blast.ShearKernel}, Union{Blast.CMBLensingKernel, Blast.GalaxyKernel, Blast.ShearKernel}, Blast.BackgroundQuantities, AbstractVector, AbstractVector{T}}} where T" href="#Blast.compute_Cℓ-Union{Tuple{T}, Tuple{AbstractArray{T, 3}, Union{Blast.CMBLensingKernel, Blast.GalaxyKernel, Blast.ShearKernel}, Union{Blast.CMBLensingKernel, Blast.GalaxyKernel, Blast.ShearKernel}, Blast.BackgroundQuantities, AbstractVector}, Tuple{AbstractArray{T, 3}, Union{Blast.CMBLensingKernel, Blast.GalaxyKernel, Blast.ShearKernel}, Union{Blast.CMBLensingKernel, Blast.GalaxyKernel, Blast.ShearKernel}, Blast.BackgroundQuantities, AbstractVector, AbstractVector{T}}} where T"><code>Blast.compute_Cℓ</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_Cℓ(w::AbstractArray{T, 3}, 
           ProbeA::Union{GalaxyKernel, ShearKernel, CMBLensingKernel}, 
           ProbeB::Union{GalaxyKernel, ShearKernel, CMBLensingKernel}, 
           BackgroundQuantities::BackgroundQuantities, 
           R::AbstractVector, 
           ℓ_list::AbstractArray{T,1} = Blast.ℓ) where T</code></pre><p>Computes the angular power spectrum <code>Cℓ</code> by performing two outer integrals over <code>χ</code> and <code>R</code>.  The Simpson quadrature rule is used for integration over <code>χ</code>, while Clenshaw-Curtis quadrature is used for <code>R</code>.</p><p><strong>Arguments</strong></p><ul><li><code>w::AbstractArray{T, 3}</code>: A 3D array representing the projected matter densities, containing the inner integrals over <code>k</code>. The array dimensions are (ℓ, χ, R).</li><li><code>ProbeA::Union{GalaxyKernel, ShearKernel, CMBLensingKernel}</code>: The first cosmological probe kernel type.</li><li><code>ProbeB::Union{GalaxyKernel, ShearKernel, CMBLensingKernel}</code>: The second cosmological probe kernel type.</li><li><code>BackgroundQuantities::BackgroundQuantities</code>: Contains background information, including <code>χz_array</code> for distances in the cosmology.</li><li><code>R::AbstractVector</code>: A 1D array representing the radial grid values for integration.</li><li><code>ℓ_list::AbstractArray{T,1}</code>: An optional 1D array of angular multipole values, defaulting to the global variable Blast.ℓ, the list of ℓ values used for the precomputed part.</li></ul><p><strong>Returns</strong></p><ul><li>A 3D array <code>Cℓ</code> with dimensions (ℓ, i, j), where <code>i</code> and <code>j</code> represent the tomographic bins. The array contains the computed angular power spectrum coefficients for each combination of <code>ℓ</code> values and tomographic bins.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/integrals.jl#L333-L354">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.compute_Cℓ-Union{Tuple{T}, Tuple{AbstractArray{T, 3}, AbstractArray{T, 4}, Blast.BackgroundQuantities, AbstractVector{T}, AbstractVector{T}, AbstractVector{T}}} where T" href="#Blast.compute_Cℓ-Union{Tuple{T}, Tuple{AbstractArray{T, 3}, AbstractArray{T, 4}, Blast.BackgroundQuantities, AbstractVector{T}, AbstractVector{T}, AbstractVector{T}}} where T"><code>Blast.compute_Cℓ</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_Cℓ(w::AbstractArray{T, 3}, 
           K::AbstractArray{T, 4}, 
           bkgq::BackgroundQuantities, 
           weights_χ::AbstractArray{T, 1}, 
           weights_R::AbstractArray{T, 1}, 
           ell_prefactor::AbstractArray{T,1}) where T</code></pre><p>Computes the angular power spectrum <code>Cℓ</code> by performing integrals over <code>χ</code> and <code>R</code> for a given set of inputs.</p><p><strong>Arguments</strong></p><ul><li><code>w::AbstractArray{T, 3}</code>: A 3D array representing the projected matter densities, containing the inner integrals over <code>k</code>. The array dimensions are (ℓ, χ, R).</li><li><code>K::AbstractArray{T, 4}</code>: A 4D array representing the kernel product <code>K[i, j, χ, R]</code> for the given cosmological probes. It combines the effects of the probes and tomographic bin combinations.</li><li><code>bkgq::BackgroundQuantities</code>: Contains background information, including <code>χz_array</code> for distances in the cosmology.</li><li><code>weights_χ::AbstractArray{T, 1}</code>: A 1D array of weights for Simpson quadrature integration over <code>χ</code>.</li><li><code>weights_R::AbstractArray{T, 1}</code>: A 1D array of weights for Clenshaw-Curtis quadrature integration over <code>R</code>.</li><li><code>ell_prefactor::AbstractArray{T,1}</code>: A 1D array of prefactors dependent on angular multipole values <code>ℓ</code>, combining with other components to form the power spectrum.</li></ul><p><strong>Returns</strong></p><ul><li>A 3D array <code>Cℓ</code> with dimensions (ℓ, i, j), where <code>i</code> and <code>j</code> represent the tomographic bins. The array contains the computed angular power spectrum coefficients for each combination of <code>ℓ</code> values and tomographic bins.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/integrals.jl#L377-L397">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.compute_adimensional_hubble_factor-Union{Tuple{T}, Tuple{T, Blast.FlatΛCDM}} where T" href="#Blast.compute_adimensional_hubble_factor-Union{Tuple{T}, Tuple{T, Blast.FlatΛCDM}} where T"><code>Blast.compute_adimensional_hubble_factor</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_adimensional_hubble_factor(z::T, cosmo::FlatΛCDM) -&gt; T</code></pre><p>Computes the adimensional Hubble factor <code>E(z)</code> for a given redshift <code>z</code>, using the  cosmological parameters from a <code>FlatΛCDM</code> model. The analitycal expression is given by:</p><p class="math-container">\[E(z)=\sqrt{\Omega_m(1+z)^3+\Omega_r(1+z)^4+
\Omega_{de}(1+z)^{3(1+w_0+w_a)}\exp(-3w_a \frac{z}{1+z})+\Omega_k(1+z)^2}\]</p><p><strong>Parameters:</strong></p><ul><li><code>z</code>: Redshift at which to evaluate the Hubble factor.</li><li><code>cosmo</code>: A <code>FlatΛCDM</code> cosmological model containing parameters like Ωm, Ωr, Ωde, etc.</li></ul><p><strong>Returns:</strong></p><ul><li><code>E_z</code>: The adimensional Hubble factor at redshift <code>z</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/background.jl#L1-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.compute_adimensional_hubble_factor-Union{Tuple{T}, NTuple{7, T}} where T" href="#Blast.compute_adimensional_hubble_factor-Union{Tuple{T}, NTuple{7, T}} where T"><code>Blast.compute_adimensional_hubble_factor</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_adimensional_hubble_factor(z::T, Ωm::T, Ωr::T, Ωde::T, Ωk::T, w0::T, wa::T) -&gt; T</code></pre><p>Computes the adimensional Hubble factor <code>E(z)</code> given the redshift <code>z</code> and individual cosmological parameters. The analitycal expression is given by:</p><p class="math-container">\[E(z)=\sqrt{\Omega_m(1+z)^3+\Omega_r(1+z)^4+
\Omega_{de}(1+z)^{3(1+w_0+w_a)}\exp(-3w_a \frac{z}{1+z})+\Omega_k(1+z)^2}\]</p><p><strong>Parameters:</strong></p><ul><li><code>z</code>: Redshift at which to evaluate the Hubble factor.</li><li><code>Ωm</code>: Matter density parameter.</li><li><code>Ωr</code>: Radiation density parameter.</li><li><code>Ωde</code>: Dark energy density parameter.</li><li><code>Ωk</code>: Curvature density parameter.</li><li><code>w0</code>: Dark energy equation of state parameter at the present time.</li><li><code>wa</code>: Time evolution of the dark energy equation of state.</li></ul><p><strong>Returns:</strong></p><ul><li><code>E_z</code>: The adimensional Hubble factor at redshift <code>z</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/background.jl#L25-L46">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.compute_hubble_factor" href="#Blast.compute_hubble_factor"><code>Blast.compute_hubble_factor</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_hubble_factor(z::T, cosmo::AbstractCosmology) -&gt; T</code></pre><p>Computes the Hubble parameter <code>H(z)</code> at a given redshift <code>z</code> using the Hubble constant <code>H0</code> and the adimensional  Hubble factor <code>E(z)</code>.</p><p><strong>Parameters:</strong></p><ul><li><code>z</code>: Redshift at which to compute the Hubble parameter.</li><li><code>cosmo</code>: A cosmological model that contains <code>H0</code> and other necessary parameters.</li></ul><p><strong>Returns:</strong></p><ul><li><code>H_z</code>: The Hubble parameter at redshift <code>z</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/background.jl#L53-L65">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.compute_χ" href="#Blast.compute_χ"><code>Blast.compute_χ</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_χ(z::T, cosmo::AbstractCosmology) -&gt; T</code></pre><p>Computes the comoving distance <code>χ(z)</code> to a given redshift <code>z</code> by numerically integrating  the inverse of the adimensional Hubble factor <code>E(z)</code>:</p><p class="math-container">\[\chi(z)=\frac{c}{H_0}\int_0^z \frac{dz&#39;}{E(z&#39;)}\]</p><p><strong>Parameters:</strong></p><ul><li><code>z</code>: Redshift up to which the comoving distance is computed.</li><li><code>cosmo</code>: A cosmological model containing the necessary parameters (e.g., Ωm, H0).</li></ul><p><strong>Returns:</strong></p><ul><li><code>χ_z</code>: The comoving distance at redshift <code>z</code> in units of Mpc.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/background.jl#L71-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.evaluate_background_quantities!" href="#Blast.evaluate_background_quantities!"><code>Blast.evaluate_background_quantities!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">evaluate_background_quantities!(grid::CosmologicalGrid, bg::BackgroundQuantities, cosmo::AbstractCosmology)</code></pre><p>Populates the <code>BackgroundQuantities</code> struct with values for the Hubble parameter <code>H(z)</code> and comoving distance <code>χ(z)</code>  over the redshift range specified by the <code>CosmologicalGrid</code>.</p><p><strong>Parameters:</strong></p><ul><li><code>grid</code>: A grid specifying the redshift range over which to evaluate the background quantities.</li><li><code>bg</code>: A mutable struct where the computed <code>H(z)</code> and <code>χ(z)</code> values will be stored.</li><li><code>cosmo</code>: A cosmological model containing the necessary parameters (e.g., H0, Ωm).</li></ul><p><strong>Notes:</strong></p><p>This function modifies the <code>BackgroundQuantities</code> struct in place by filling the arrays with the computed values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/background.jl#L92-L105">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.compute_kernel!-Union{Tuple{T}, Tuple{AbstractMatrix{T}, AbstractVector{T}, Blast.GalaxyKernel, Blast.CosmologicalGrid, Blast.BackgroundQuantities, Blast.AbstractCosmology}} where T" href="#Blast.compute_kernel!-Union{Tuple{T}, Tuple{AbstractMatrix{T}, AbstractVector{T}, Blast.GalaxyKernel, Blast.CosmologicalGrid, Blast.BackgroundQuantities, Blast.AbstractCosmology}} where T"><code>Blast.compute_kernel!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_kernel!(nz::AbstractArray{T, 2}, Probe::GalaxyKernel, z::AbstractArray{T, 1},
                grid::CosmologicalGrid, bg::BackgroundQuantities, 
                cosmo::AbstractCosmology) where T</code></pre><p>Computes the galaxy clustering kernel based on a redshift distribution <code>nz</code> and stores it in the <code>GalaxyKernel</code> struct.  The kernel is defined as: </p><p class="math-container">\[W_g(\chi) = \frac{H(z)}{c}n(z)\]</p><p><strong>Parameters:</strong></p><ul><li><code>nz</code>: A 2D array of type <code>T</code> where each row represents the redshift distribution of galaxies for a specific redshift bin.</li><li><code>z</code>: The redshift grid corresponding to the <code>nz</code> array.</li><li><code>Probe</code>: An instance of <code>GalaxyKernel</code>, in which the computed kernel values for each redshift bin will be stored.</li><li><code>grid</code>: A <code>CosmologicalGrid</code> object specifying the redshift range and grid points for kernel computation.</li><li><code>bg</code>: A struct containing arrays of Hubble parameter (<code>Hz_array</code>) and comoving distance (<code>χz_array</code>), precomputed over the grid.</li><li><code>cosmo</code>: An instance of a cosmological model used to calculate the background quantities if not already provided.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/background.jl#L119-L138">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.compute_kernel!-Union{Tuple{T}, Tuple{AbstractMatrix{T}, AbstractVector{T}, Blast.ShearKernel, Blast.CosmologicalGrid, Blast.BackgroundQuantities, Blast.AbstractCosmology}} where T" href="#Blast.compute_kernel!-Union{Tuple{T}, Tuple{AbstractMatrix{T}, AbstractVector{T}, Blast.ShearKernel, Blast.CosmologicalGrid, Blast.BackgroundQuantities, Blast.AbstractCosmology}} where T"><code>Blast.compute_kernel!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_kernel!(nz::AbstractArray{T, 2}, Probe::ShearKernel, z::AbstractArray{T, 1},
                grid::CosmologicalGrid, bg::BackgroundQuantities, 
                cosmo::AbstractCosmology) where T</code></pre><p>Computes the weak lensing shear kernel based on a redshift distribution <code>nz</code> and stores it in the <code>ShearKernel</code> struct.  The kernel is defined as: </p><p class="math-container">\[W_{\gamma}(\chi) = \frac{3}{2}\frac{H_0^2}{c^2}\Omega_m \frac{\chi}{a(\chi)}\int_{z(\chi)}^{\infty}dz&#39;n(z&#39;)\frac{\chi(z&#39;)-\chi}{\chi(z&#39;)}\]</p><p><strong>Parameters:</strong></p><ul><li><code>nz</code>: A 2D array of type <code>T</code> where each row corresponds to the redshift distribution for a specific shear redshift bin.</li><li><code>z</code>: The redshift grid corresponding to the nz array.</li><li><code>Probe</code>: An instance of <code>ShearKernel</code>, where computed kernel values for each redshift bin will be stored.</li><li><code>grid</code>: A <code>CosmologicalGrid</code> object defining the redshift range and grid points for kernel computation.</li><li><code>bg</code>: A struct containing precomputed Hubble parameter (<code>Hz_array</code>) and comoving distance (<code>χz_array</code>) arrays over the grid.</li><li><code>cosmo</code>: An instance of a cosmological model that provides background parameters needed for lensing kernel calculations.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/background.jl#L158-L176">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Blast.compute_kernel!-Tuple{Blast.CMBLensingKernel, Blast.CosmologicalGrid, Blast.BackgroundQuantities, Blast.AbstractCosmology}" href="#Blast.compute_kernel!-Tuple{Blast.CMBLensingKernel, Blast.CosmologicalGrid, Blast.BackgroundQuantities, Blast.AbstractCosmology}"><code>Blast.compute_kernel!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_kernel!(Probe::CMBLensingKernel, 
                grid::CosmologicalGrid, bg::BackgroundQuantities, 
                cosmo::AbstractCosmology)</code></pre><p>Computes the CMB lensing kernel and stores it in the <code>CMBLensingKernel</code> struct. The kernel is defined as: </p><p class="math-container">\[W_{\kappa}(\chi) = \frac{3}{2}\frac{H_0^2}{c^2}\Omega_m \frac{\chi}{a(\chi)}\frac{\chi^*-\chi}{\chi^*},\]</p><p>where <span>$\chi^* = \chi(z_{\mathrm{CMB}} = 1100)$</span></p><p><strong>Parameters:</strong></p><ul><li><code>Probe</code>: An instance of <code>CMBLensingKernel</code> to store the computed kernel values.</li><li><code>grid</code>: A grid specifying the redshift range over which the kernel is computed.</li><li><code>bg</code>: A struct containing precomputed Hubble parameter and comoving distance values.</li><li><code>cosmo</code>: A cosmological model.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sofiachiarenza/Blast.jl/blob/3c4b6124d653e177072c2c6cce893bdb830f265e/src/background.jl#L204-L222">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../alg/">« The algorithm</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Wednesday 6 November 2024 23:15">Wednesday 6 November 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
